<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Usta AI - Fiyatlandƒ±rma</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #ff6b35, #ff8e53);
            color: white;
            padding: 25px 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 1.4em;
            margin-bottom: 5px;
        }

        .screen {
            display: none;
            padding: 20px;
            min-height: 400px;
        }

        .screen.active {
            display: block;
        }

        .product-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }

        .product-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 8px;
            border-radius: 12px;
            font-size: 0.95em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            min-height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .product-btn.selected {
            background: linear-gradient(135deg, #ff6b35, #ff8e53);
        }

        .option-grid {
            display: grid;
            gap: 10px;
            margin-top: 20px;
        }

        .option-btn {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            padding: 15px;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .option-btn.selected {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }

        .text-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 1em;
            margin-top: 10px;
            font-family: inherit;
        }

        .number-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 1.2em;
            font-weight: 600;
            text-align: center;
        }

        .dimension-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }

        .dimension-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            text-align: center;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
            gap: 10px;
        }

        .nav-btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
        }

        .back-btn {
            background: #6c757d;
            color: white;
        }

        .next-btn {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }

        .nav-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .whatsapp-btn {
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
            border: none;
            padding: 18px;
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            text-align: center;
            width: 100%;
            margin-top: 20px;
        }

        .section-title {
            color: #495057;
            margin: 20px 0 10px 0;
            font-size: 1.1em;
            border-left: 4px solid #ff6b35;
            padding-left: 10px;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }

        .upload-area {
            border: 2px dashed #667eea;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            margin: 20px 0;
            background: #f8f9ff;
            cursor: pointer;
        }

        .upload-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .photo-preview {
            max-width: 100%;
            max-height: 200px;
            border-radius: 10px;
            margin-top: 10px;
            display: none;
        }

        .dimension-unit {
            position: relative;
        }

        .dimension-unit::after {
            content: "cm";
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #666;
            font-weight: 600;
        }

        .camera-container {
            position: relative;
            width: 100%;
            height: 300px;
            background: #000;
            border-radius: 10px;
            overflow: hidden;
            margin: 15px 0;
        }

        #camera-preview {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .camera-controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
        }

        .camera-btn {
            background: rgba(255,255,255,0.9);
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 1.5em;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .source-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }

        .source-btn {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            padding: 15px;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .source-btn:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .hidden-file-input {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè† Usta AI Fiyatlandƒ±rma</h1>
            <p>Mobilyanƒ±zƒ± kolayca hesaplayƒ±n</p>
        </div>

        <!-- √úr√ºn Se√ßim Ekranƒ± -->
        <div class="screen active" id="screen-product">
            <h2>Hangi √ºr√ºn√º yaptƒ±rmak istiyorsunuz?</h2>
            <div class="product-grid">
                <button class="product-btn" data-product="MUTFAK DOLABI">üç≥ Mutfak Dolabƒ±</button>
                <button class="product-btn" data-product="GARDROP">üëî Gardƒ±rop</button>
                <button class="product-btn" data-product="≈ûƒ∞FONYER">üõèÔ∏è ≈ûifonyer</button>
                <button class="product-btn" data-product="TV √úNƒ∞TESƒ∞">üì∫ TV √únitesi</button>
                <button class="product-btn" data-product="DUVAR PANELƒ∞">üñºÔ∏è Duvar Paneli</button>
                <button class="product-btn" data-product="PORTMANTO">üß• Portmanto</button>
                <button class="product-btn" data-product="ODA KAPISI">üö™ Oda Kapƒ±sƒ±</button>
                <button class="product-btn" data-product="BANYO DOLABI">üöø Banyo Dolabƒ±</button>
                <button class="product-btn" data-product="KAHVE K√ñ≈ûESƒ∞">‚òï Kahve K√∂≈üesi</button>
                <button class="product-btn" data-product="Dƒ∞ƒûERLERƒ∞">üì¶ Diƒüerleri</button>
            </div>
            <div class="navigation">
                <button class="nav-btn back-btn" disabled>Geri</button>
                <button class="nav-btn next-btn" id="next-product" disabled>Devam</button>
            </div>
        </div>

        <!-- √ñL√á√ú EKRANI - T√úM √úR√úNLER ƒ∞√áƒ∞N -->
        <div class="screen" id="screen-dimensions">
            <h2>√úr√ºn √∂l√ß√ºlerini girin</h2>
            
            <div class="section-title">Geni≈ülik</div>
            <div class="dimension-unit">
                <input type="number" class="dimension-input" placeholder="0" id="input-width">
            </div>

            <div class="section-title">Y√ºkseklik</div>
            <div class="dimension-unit">
                <input type="number" class="dimension-input" placeholder="0" id="input-height">
            </div>

            <div class="section-title">Derinlik</div>
            <div class="dimension-unit">
                <input type="number" class="dimension-input" placeholder="0" id="input-depth">
            </div>

            <div class="navigation">
                <button class="nav-btn back-btn" onclick="showScreen('screen-product')">Geri</button>
                <button class="nav-btn next-btn" id="next-dimensions" disabled>Devam</button>
            </div>
        </div>

        <!-- KAPI √ñZEL EKRANLARI -->
        <div class="screen" id="screen-door-type">
            <h2>Kapƒ± tipini se√ßin</h2>
            <div class="option-grid">
                <button class="option-btn" data-type="√áITALI KAPI">√áITALI KAPI</button>
                <button class="option-btn" data-type="D√úZ KAPI">D√úZ KAPI</button>
            </div>
            <div class="navigation">
                <button class="nav-btn back-btn" onclick="showScreen('screen-dimensions')">Geri</button>
                <button class="nav-btn next-btn" id="next-door-type" disabled>Devam</button>
            </div>
        </div>

        <div class="screen" id="screen-door-glass">
            <h2>Cam se√ßin</h2>
            <div class="option-grid">
                <button class="option-btn" data-glass="CAMLI KAPI">CAMLI KAPI</button>
                <button class="option-btn" data-glass="CAMSIZ KAPI">CAMSIZ KAPI</button>
            </div>
            <div class="navigation">
                <button class="nav-btn back-btn" onclick="showScreen('screen-door-type')">Geri</button>
                <button class="nav-btn next-btn" id="next-door-glass" disabled>Devam</button>
            </div>
        </div>

        <div class="screen" id="screen-door-count">
            <h2>Ka√ß adet kapƒ±?</h2>
            <input type="number" class="number-input" placeholder="Kapƒ± sayƒ±sƒ±" id="input-door-count">
            <div class="navigation">
                <button class="nav-btn back-btn" onclick="showScreen('screen-door-glass')">Geri</button>
                <button class="nav-btn next-btn" id="next-door-count" disabled>Devam</button>
            </div>
        </div>

        <!-- Dƒ∞ƒûER √úR√úNLER ƒ∞√áƒ∞N KATEGORƒ∞LER -->
        
        <!-- G√∂vde Malzemesi -->
        <div class="screen" id="screen-body">
            <h2>G√∂vde malzemesini se√ßin</h2>
            <div class="option-grid">
                <button class="option-btn" data-body="MDF LAM">MDF LAM</button>
                <button class="option-btn" data-body="LAKE">LAKE</button>
                <button class="option-btn" data-body="YOK">Yok</button>
            </div>
            <div class="navigation">
                <button class="nav-btn back-btn" onclick="showScreen('screen-dimensions')">Geri</button>
                <button class="nav-btn next-btn" id="next-body" disabled>Devam</button>
            </div>
        </div>

        <!-- Kapaklar -->
        <div class="screen" id="screen-covers">
            <h2>Kapak malzemesini se√ßin</h2>
            <div class="option-grid">
                <button class="option-btn" data-cover="MDF LAM">MDF LAM</button>
                <button class="option-btn" data-cover="LAKE">LAKE</button>
                <button class="option-btn" data-cover="AL√úMƒ∞NYUM √áER√áEVE KAPAK">AL√úMƒ∞NYUM √áER√áEVE KAPAK</button>
                <button class="option-btn" data-cover="YOK">Yok</button>
            </div>
            <div class="navigation">
                <button class="nav-btn back-btn" onclick="showScreen('screen-body')">Geri</button>
                <button class="nav-btn next-btn" id="next-covers" disabled>Devam</button>
            </div>
        </div>

        <!-- Doku -->
        <div class="screen" id="screen-texture">
            <h2>Y√ºzey dokusunu se√ßin</h2>
            <div class="option-grid">
                <button class="option-btn" data-texture="MAT">MAT</button>
                <button class="option-btn" data-texture="PARLAK">PARLAK</button>
                <button class="option-btn" data-texture="YOK">Yok</button>
            </div>
            <div class="navigation">
                <button class="nav-btn back-btn" onclick="showScreen('screen-covers')">Geri</button>
                <button class="nav-btn next-btn" id="next-texture" disabled>Devam</button>
            </div>
        </div>

        <!-- Kapak T√ºr√º -->
        <div class="screen" id="screen-cover-type">
            <h2>Kapak t√ºr√ºn√º se√ßin</h2>
            <div class="option-grid">
                <button class="option-btn" data-covertype="AKRƒ∞Lƒ∞K">AKRƒ∞Lƒ∞K</button>
                <button class="option-btn" data-covertype="D√úZ LAKE">D√úZ LAKE</button>
                <button class="option-btn" data-covertype="KLAPALI LAKE">KLAPALI LAKE</button>
                <button class="option-btn" data-covertype="CNC ƒ∞≈ûLEMELƒ∞ LAKE">CNC ƒ∞≈ûLEMELƒ∞ LAKE</button>
                <button class="option-btn" data-covertype="YOK">Yok</button>
            </div>
            <div class="navigation">
                <button class="nav-btn back-btn" onclick="showScreen('screen-texture')">Geri</button>
                <button class="nav-btn next-btn" id="next-cover-type" disabled>Devam</button>
            </div>
        </div>

        <!-- Sayƒ±lar -->
        <div class="screen" id="screen-counts">
            <h2>√áekmece ve kapak sayƒ±larƒ±nƒ± girin</h2>
            
            <div class="section-title">√áekmece Sayƒ±sƒ±</div>
            <input type="number" class="number-input" placeholder="√áekmece sayƒ±sƒ±" id="input-drawers">
            
            <div class="section-title">Kapak Sayƒ±sƒ±</div>
            <input type="number" class="number-input" placeholder="Kapak sayƒ±sƒ±" id="input-covers-count">
            
            <div class="navigation">
                <button class="nav-btn back-btn" onclick="showScreen('screen-cover-type')">Geri</button>
                <button class="nav-btn next-btn" id="next-counts" disabled>Devam</button>
            </div>
        </div>

        <!-- Aksesuarlar -->
        <div class="screen" id="screen-accessories">
            <h2>Aksesuar se√ßenekleri</h2>
            
            <div class="section-title">Ayna</div>
            <div class="option-grid">
                <button class="option-btn" data-mirror="AYNALI">AYNALI</button>
                <button class="option-btn" data-mirror="AYNASIZ">AYNASIZ</button>
            </div>

            <div class="section-title">Ray Sistemleri</div>
            <div class="option-grid">
                <button class="option-btn" data-rails="SAMET RAY">SAMET RAY</button>
                <button class="option-btn" data-rails="BLUM RAY">BLUM RAY</button>
                <button class="option-btn" data-rails="HAFELE RAY">HAFELE RAY</button>
                <button class="option-btn" data-rails="YOK">Yok</button>
            </div>

            <div class="section-title">Kulp</div>
            <div class="option-grid">
                <button class="option-btn" data-handle="KULPLU">KULPLU</button>
                <button class="option-btn" data-handle="KULPSUZ">KULPSUZ</button>
            </div>

            <div class="navigation">
                <button class="nav-btn back-btn" onclick="showScreen('screen-counts')">Geri</button>
                <button class="nav-btn next-btn" id="next-accessories" disabled>Devam</button>
            </div>
        </div>

        <!-- Dƒ∞ƒûER Bƒ∞LGƒ∞LER EKRANI -->
        <div class="screen" id="screen-other-info">
            <h2>Diƒüer Bilgiler</h2>
            <p style="color: #666; margin-bottom: 20px;">Eklemek istediƒüiniz diƒüer detaylarƒ± yazƒ±n</p>
            
            <div class="input-group">
                <label class="input-label">√ñzel Notlar</label>
                <textarea class="text-input" placeholder="Eklemek istediƒüiniz √∂zel notlar, detaylar, istekler..." id="input-notes" rows="4"></textarea>
            </div>

            <div class="navigation">
                <button class="nav-btn back-btn" onclick="goBack()">Geri</button>
                <button class="nav-btn next-btn" id="next-other-info">Devam</button>
            </div>
        </div>

        <!-- DUVAR FOTOƒûRAFI EKRANI - SADECE KAMERA -->
        <div class="screen" id="screen-wall-photo">
            <h2>Duvar Fotoƒürafƒ± √áekin</h2>
            <p style="color: #666; margin-bottom: 20px;">√úr√ºn√ºn uygulanacaƒüƒ± duvarƒ±n fotoƒürafƒ±nƒ± √ßekin</p>
            
            <div class="camera-container">
                <video id="camera-preview" autoplay playsinline></video>
                <div class="camera-controls">
                    <button class="camera-btn" onclick="capturePhoto()">üì∏</button>
                </div>
            </div>
            
            <div id="wall-photo-preview-container" style="display: none;">
                <div class="section-title">√áekilen Fotoƒüraf</div>
                <img id="wall-photo-preview" class="photo-preview" alt="Duvar Fotoƒürafƒ±">
            </div>

            <div class="navigation">
                <button class="nav-btn back-btn" onclick="showScreen('screen-other-info')">Geri</button>
                <button class="nav-btn next-btn" id="next-wall-photo" disabled>Devam</button>
            </div>
        </div>

        <!-- REFERANS FOTOƒûRAF EKRANI - SADECE GALERƒ∞/CHROME -->
        <div class="screen" id="screen-reference-photo">
            <h2>Referans Fotoƒüraf Y√ºkleyin</h2>
            <p style="color: #666; margin-bottom: 20px;">Beƒüendiƒüiniz √ºr√ºn√ºn fotoƒürafƒ±nƒ± y√ºkleyin</p>
            
            <div class="upload-area" onclick="document.getElementById('reference-file-input').click()">
                <div class="upload-icon">üñºÔ∏è</div>
                <div style="font-weight: 600; margin-bottom: 5px;">Referans Fotoƒüraf Y√ºkle</div>
                <div style="color: #666; font-size: 0.9em;">Galeriden veya internetten fotoƒüraf se√ßin</div>
                <input type="file" id="reference-file-input" accept="image/*" class="hidden-file-input" onchange="handleReferencePhotoSelect(event)">
                <img id="reference-photo-preview" class="photo-preview" alt="Referans √ñnizleme">
            </div>

            <div class="source-buttons">
                <button class="source-btn" onclick="document.getElementById('reference-file-input').click()">
                    üì± Galeriden Se√ß
                </button>
                <button class="source-btn" onclick="openImageSearch()">
                    üåê Chrome'dan Ara
                </button>
            </div>

            <div class="navigation">
                <button class="nav-btn back-btn" onclick="showScreen('screen-wall-photo')">Geri</button>
                <button class="nav-btn next-btn" id="next-reference-photo" disabled>Devam</button>
            </div>
        </div>

        <!-- Ki≈üisel Bilgiler -->
        <div class="screen" id="screen-personal">
            <h2>ƒ∞leti≈üim bilgilerinizi girin</h2>
            
            <div class="input-group">
                <label class="input-label">Ad Soyad</label>
                <input type="text" class="text-input" placeholder="Adƒ±nƒ±z ve soyadƒ±nƒ±z" id="input-name">
            </div>

            <div class="input-group">
                <label class="input-label">Telefon Numarasƒ±</label>
                <input type="tel" class="text-input" placeholder="Telefon numaranƒ±z" id="input-phone">
            </div>

            <div class="input-group">
                <label class="input-label">Adres</label>
                <textarea class="text-input" placeholder="Teslimat adresiniz" id="input-address" rows="3"></textarea>
            </div>

            <div class="navigation">
                <button class="nav-btn back-btn" onclick="showScreen('screen-reference-photo')">Geri</button>
                <button class="nav-btn next-btn" id="next-personal" disabled>WhatsApp'tan Fiyat ƒ∞ste</button>
            </div>
        </div>

        <!-- WhatsApp -->
        <div class="screen" id="screen-whatsapp">
            <h2>Fiyat talebiniz hazƒ±r! üéâ</h2>
            <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin: 20px 0;">
                <div><strong>√úr√ºn:</strong> <span id="summary-product"></span></div>
                <div><strong>√ñl√ß√ºler:</strong> <span id="summary-dimensions"></span></div>
                <div id="door-details"></div>
                <div id="other-details"></div>
                <div id="notes-details"></div>
                <div id="photo-details"></div>
                <div><strong>Ad Soyad:</strong> <span id="summary-name"></span></div>
                <div><strong>Telefon:</strong> <span id="summary-phone"></span></div>
                <div><strong>Adres:</strong> <span id="summary-address"></span></div>
            </div>
            
            <!-- Fotoƒüraf √ñnizlemeleri -->
            <div id="whatsapp-photo-previews" style="margin: 20px 0;"></div>
            
            <button class="whatsapp-btn" onclick="sendToWhatsApp()">
                üì± WhatsApp'tan G√∂nder
            </button>
            <div class="navigation">
                <button class="nav-btn back-btn" onclick="showScreen('screen-personal')">Geri</button>
                <button class="nav-btn next-btn" onclick="restartApp()">Yeni Talep</button>
            </div>
        </div>
    </div>

    <script>
        let userSelection = {
            product: '',
            dimensions: { width: '', height: '', depth: '' },
            // Kapƒ± i√ßin
            doorType: '', doorGlass: '', doorCount: '',
            // Diƒüer √ºr√ºnler i√ßin
            body: '', cover: '', texture: '', coverType: '',
            drawers: '', coversCount: '', mirror: '', rails: '', handle: '',
            // Yeni eklenenler
            notes: '', wallPhoto: null, referencePhoto: null,
            // Ki≈üisel bilgiler
            name: '', phone: '', address: ''
        };

        let cameraStream = null;

        // 1. KAMERA GENƒ∞≈û A√áI AYARI
        async function startCamera() {
            try {
                // √ñnce geni≈ü a√ßƒ±lƒ± kamera ara
                const devices = await navigator.mediaDevices.enumerateDevices();
                const videoDevices = devices.filter(device => device.kind === 'videoinput');
                
                let constraints = {
                    video: { 
                        width: { ideal: 1920 },
                        height: { ideal: 1080 },
                        aspectRatio: { ideal: 1.7777777778 } // 16:9 geni≈ü ekran
                    } 
                };

                // Geni≈ü a√ßƒ±lƒ± kamera bulmaya √ßalƒ±≈ü
                const wideAngleDevice = videoDevices.find(device => 
                    device.label.toLowerCase().includes('wide') || 
                    device.label.toLowerCase().includes('back')
                );

                if (wideAngleDevice) {
                    constraints.video.deviceId = { exact: wideAngleDevice.deviceId };
                }

                cameraStream = await navigator.mediaDevices.getUserMedia(constraints);
                const preview = document.getElementById('camera-preview');
                preview.srcObject = cameraStream;
                
            } catch (err) {
                console.error('Kamera eri≈üim hatasƒ±:', err);
                // Geni≈ü a√ßƒ± olmazsa normal kamera kullan
                try {
                    cameraStream = await navigator.mediaDevices.getUserMedia({ 
                        video: { facingMode: 'environment' } 
                    });
                    const preview = document.getElementById('camera-preview');
                    preview.srcObject = cameraStream;
                } catch (err2) {
                    alert('Kameraya eri≈üim izni gerekiyor. L√ºtfen tarayƒ±cƒ± ayarlarƒ±ndan kamerayƒ± etkinle≈ütirin.');
                }
            }
        }

        // Kamera durdurma
        function stopCamera() {
            if (cameraStream) {
                cameraStream.getTracks().forEach(track => track.stop());
                cameraStream = null;
            }
        }

        // Fotoƒüraf √ßekme
        function capturePhoto() {
            const preview = document.getElementById('camera-preview');
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            
            canvas.width = preview.videoWidth;
            canvas.height = preview.videoHeight;
            context.drawImage(preview, 0, 0, canvas.width, canvas.height);
            
            userSelection.wallPhoto = canvas.toDataURL('image/jpeg');
            
            const photoPreview = document.getElementById('wall-photo-preview');
            const container = document.getElementById('wall-photo-preview-container');
            photoPreview.src = userSelection.wallPhoto;
            container.style.display = 'block';
            photoPreview.style.display = 'block';
            
            document.getElementById('next-wall-photo').disabled = false;
        }

        // 2. CHROME ENTEGRASYONU - GELƒ∞≈ûMƒ∞≈û
        function openImageSearch() {
            const productName = userSelection.product.toLowerCase();
            const searchUrl = `https://www.google.com/search?q=${encodeURIComponent(productName + ' mobilya tasarƒ±m')}&tbm=isch`;
            
            // Yeni pencere a√ß
            const newWindow = window.open(searchUrl, '_blank');
            
            // Kullanƒ±cƒ±ya bilgi ver
            alert('L√ºtfen beƒüendiƒüiniz fotoƒürafa tƒ±klayƒ±n, "Resmi farklƒ± kaydet" diyerek indirin, sonra "Galeriden Se√ß" butonu ile y√ºkleyin.');
            
            // Alternatif olarak dosya input'unu tetikle (kullanƒ±cƒ± indirdikten sonra)
            setTimeout(() => {
                document.getElementById('reference-file-input').click();
            }, 3000);
        }

        function handleReferencePhotoSelect(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    userSelection.referencePhoto = e.target.result;
                    const preview = document.getElementById('reference-photo-preview');
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                    document.getElementById('next-reference-photo').disabled = false;
                }
                reader.readAsDataURL(file);
            }
        }

        // Ekran deƒüi≈üimlerinde kamera y√∂netimi
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
            
            // Kamera ekranƒ±na ge√ßildiƒüinde kamerayƒ± ba≈ülat
            if (screenId === 'screen-wall-photo') {
                setTimeout(startCamera, 100);
            } else if (cameraStream) {
                // Diƒüer ekranlara ge√ßildiƒüinde kamerayƒ± durdur
                stopCamera();
            }
        }

        // 3. WHATSAPP FOTOƒûRAF G√ñNDERƒ∞Mƒ∞
        function sendToWhatsApp() {
            let message = `üè† Usta AI Fiyat Talebi\n\n`;
            message += `üë§ M√º≈üteri Bilgileri:\n`;
            message += `Ad Soyad: ${userSelection.name}\n`;
            message += `Telefon: ${userSelection.phone}\n`;
            message += `Adres: ${userSelection.address}\n\n`;
            message += `üì¶ √úr√ºn Detaylarƒ±:\n`;
            message += `√úr√ºn: ${userSelection.product}\n`;
            message += `√ñl√ß√ºler: ${userSelection.dimensions.width}x${userSelection.dimensions.height}x${userSelection.dimensions.depth} cm\n`;
            
            if (userSelection.product === 'ODA KAPISI') {
                message += `Kapƒ± Tipi: ${userSelection.doorType}\n`;
                message += `Cam: ${userSelection.doorGlass}\n`;
                message += `Adet: ${userSelection.doorCount}\n`;
            } else {
                if (userSelection.body) message += `G√∂vde: ${userSelection.body}\n`;
                if (userSelection.cover) message += `Kapak: ${userSelection.cover}\n`;
                if (userSelection.texture) message += `Doku: ${userSelection.texture}\n`;
                if (userSelection.coverType) message += `Kapak T√ºr√º: ${userSelection.coverType}\n`;
                if (userSelection.drawers) message += `√áekmece: ${userSelection.drawers} adet\n`;
                if (userSelection.coversCount) message += `Kapak: ${userSelection.coversCount} adet\n`;
                if (userSelection.mirror) message += `Ayna: ${userSelection.mirror}\n`;
                if (userSelection.rails) message += `Ray: ${userSelection.rails}\n`;
                if (userSelection.handle) message += `Kulp: ${userSelection.handle}\n`;
            }
            
            if (userSelection.notes) {
                message += `\nüìù √ñzel Notlar:\n${userSelection.notes}\n`;
            }
            
            message += `\nüì∏ Fotoƒüraflar g√∂nderiliyor...\n\n`;
            message += `üìû Detaylƒ± fiyatlandƒ±rma i√ßin ileti≈üime ge√ßelim!`;
            
            const phone = '905340550450';
            
            // WhatsApp'a mesajƒ± g√∂nder
            const whatsappUrl = `https://wa.me/${phone}?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
            
            // Fotoƒüraflarƒ± ayrƒ±ca g√∂nder (WhatsApp Web API kullanƒ±larak)
            setTimeout(() => {
                if (userSelection.wallPhoto) {
                    // Base64'i blob'a √ßevir
                    const wallBlob = dataURLToBlob(userSelection.wallPhoto);
                    const wallFile = new File([wallBlob], "duvar_fotografi.jpg", { type: "image/jpeg" });
                    // Burada WhatsApp'a fotoƒüraf g√∂nderme i≈ülemi yapƒ±labilir
                    console.log("Duvar fotoƒürafƒ± hazƒ±r:", wallFile);
                }
                
                if (userSelection.referencePhoto) {
                    const referenceBlob = dataURLToBlob(userSelection.referencePhoto);
                    const referenceFile = new File([referenceBlob], "referans_fotografi.jpg", { type: "image/jpeg" });
                    console.log("Referans fotoƒürafƒ± hazƒ±r:", referenceFile);
                }
            }, 1000);
        }

        // Base64 to Blob converter
        function dataURLToBlob(dataURL) {
            const byteString = atob(dataURL.split(',')[1]);
            const mimeString = dataURL.split(',')[0].split(':')[1].split(';')[0];
            const ab = new ArrayBuffer(byteString.length);
            const ia = new Uint8Array(ab);
            for (let i = 0; i < byteString.length; i++) {
                ia[i] = byteString.charCodeAt(i);
            }
            return new Blob([ab], { type: mimeString });
        }

        // Mevcut diƒüer fonksiyonlar AYNI KALACAK
        function goBack() {
            if (userSelection.product === 'ODA KAPISI') {
                showScreen('screen-door-count');
            } else {
                showScreen('screen-accessories');
            }
        }

        function restartApp() {
            userSelection = {
                product: '', dimensions: { width: '', height: '', depth: '' },
                doorType: '', doorGlass: '', doorCount: '',
                body: '', cover: '', texture: '', coverType: '',
                drawers: '', coversCount: '', mirror: '', rails: '', handle: '',
                notes: '', wallPhoto: null, referencePhoto: null,
                name: '', phone: '', address: ''
            };
            document.querySelectorAll('.product-btn, .option-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            document.querySelectorAll('input, textarea').forEach(input => {
                input.value = '';
            });
            document.querySelectorAll('.photo-preview').forEach(preview => {
                preview.style.display = 'none';
            });
            document.getElementById('wall-photo-preview-container').style.display = 'none';
            document.getElementById('whatsapp-photo-previews').innerHTML = '';
            document.querySelectorAll('.next-btn').forEach(btn => {
                btn.disabled = true;
            });
            showScreen('screen-product');
        }

        function updateSummary() {
            document.getElementById('summary-product').textContent = userSelection.product;
            document.getElementById('summary-dimensions').textContent = 
                `${userSelection.dimensions.width}x${userSelection.dimensions.height}x${userSelection.dimensions.depth} cm`;
            document.getElementById('summary-name').textContent = userSelection.name;
            document.getElementById('summary-phone').textContent = userSelection.phone;
            document.getElementById('summary-address').textContent = userSelection.address;
            
            let doorDetails = '';
            let otherDetails = '';
            let notesDetails = '';
            let photoDetails = '';
            
            if (userSelection.product === 'ODA KAPISI') {
                doorDetails = `
                    <div><strong>Kapƒ± Tipi:</strong> ${userSelection.doorType}</div>
                    <div><strong>Cam:</strong> ${userSelection.doorGlass}</div>
                    <div><strong>Adet:</strong> ${userSelection.doorCount}</div>
                `;
            } else {
                otherDetails = `
                    ${userSelection.body ? `<div><strong>G√∂vde:</strong> ${userSelection.body}</div>` : ''}
                    ${userSelection.cover ? `<div><strong>Kapak:</strong> ${userSelection.cover}</div>` : ''}
                    ${userSelection.texture ? `<div><strong>Doku:</strong> ${userSelection.texture}</div>` : ''}
                    ${userSelection.coverType ? `<div><strong>Kapak T√ºr√º:</strong> ${userSelection.coverType}</div>` : ''}
                    ${userSelection.drawers ? `<div><strong>√áekmece:</strong> ${userSelection.drawers} adet</div>` : ''}
                    ${userSelection.coversCount ? `<div><strong>Kapak:</strong> ${userSelection.coversCount} adet</div>` : ''}
                    ${userSelection.mirror ? `<div><strong>Ayna:</strong> ${userSelection.mirror}</div>` : ''}
                    ${userSelection.rails ? `<div><strong>Ray:</strong> ${userSelection.rails}</div>` : ''}
                    ${userSelection.handle ? `<div><strong>Kulp:</strong> ${userSelection.handle}</div>` : ''}
                `;
            }
            
            if (userSelection.notes) {
                notesDetails = `<div><strong>√ñzel Notlar:</strong> ${userSelection.notes}</div>`;
            }
            
            // Fotoƒüraf √∂nizlemeleri
            const photoPreviews = document.getElementById('whatsapp-photo-previews');
            photoPreviews.innerHTML = '';
            
            if (userSelection.wallPhoto) {
                photoPreviews.innerHTML += `
                    <div style="margin-bottom: 10px;">
                        <div class="section-title">Duvar Fotoƒürafƒ±</div>
                        <img src="${userSelection.wallPhoto}" style="max-width: 100%; max-height: 150px; border-radius: 10px;">
                    </div>
                `;
            }
            
            if (userSelection.referencePhoto) {
                photoPreviews.innerHTML += `
                    <div style="margin-bottom: 10px;">
                        <div class="section-title">Referans Fotoƒüraf</div>
                        <img src="${userSelection.referencePhoto}" style="max-width: 100%; max-height: 150px; border-radius: 10px;">
                    </div>
                `;
            }
            
            document.getElementById('door-details').innerHTML = doorDetails;
            document.getElementById('other-details').innerHTML = otherDetails;
            document.getElementById('notes-details').innerHTML = notesDetails;
        }

        // Event Listeners - MEVCUT KOD AYNI
        document.addEventListener('DOMContentLoaded', function() {
            // √úr√ºn se√ßimi
            document.querySelectorAll('.product-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.product-btn').forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                    userSelection.product = this.dataset.product;
                    document.getElementById('next-product').disabled = false;
                });
            });

            // √ñl√ß√º giri≈üleri
            document.getElementById('input-width').addEventListener('input', function() {
                userSelection.dimensions.width = this.value;
                updateDimensionsButton();
            });

            document.getElementById('input-height').addEventListener('input', function() {
                userSelection.dimensions.height = this.value;
                updateDimensionsButton();
            });

            document.getElementById('input-depth').addEventListener('input', function() {
                userSelection.dimensions.depth = this.value;
                updateDimensionsButton();
            });

            function updateDimensionsButton() {
                const nextBtn = document.getElementById('next-dimensions');
                nextBtn.disabled = !(userSelection.dimensions.width && userSelection.dimensions.height && userSelection.dimensions.depth);
            }

            // Kapƒ± √∂zel ekranlarƒ±
            document.querySelectorAll('#screen-door-type .option-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('#screen-door-type .option-btn').forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                    userSelection.doorType = this.dataset.type;
                    document.getElementById('next-door-type').disabled = false;
                });
            });

            document.querySelectorAll('#screen-door-glass .option-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('#screen-door-glass .option-btn').forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                    userSelection.doorGlass = this.dataset.glass;
                    document.getElementById('next-door-glass').disabled = false;
                });
            });

            document.getElementById('input-door-count').addEventListener('input', function() {
                userSelection.doorCount = this.value;
                document.getElementById('next-door-count').disabled = !this.value;
            });

            // Diƒüer √ºr√ºnler kategorileri
            document.querySelectorAll('#screen-body .option-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('#screen-body .option-btn').forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                    userSelection.body = this.dataset.body;
                    document.getElementById('next-body').disabled = false;
                });
            });

            document.querySelectorAll('#screen-covers .option-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('#screen-covers .option-btn').forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                    userSelection.cover = this.dataset.cover;
                    document.getElementById('next-covers').disabled = false;
                });
            });

            document.querySelectorAll('#screen-texture .option-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('#screen-texture .option-btn').forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                    userSelection.texture = this.dataset.texture;
                    document.getElementById('next-texture').disabled = false;
                });
            });

            document.querySelectorAll('#screen-cover-type .option-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('#screen-cover-type .option-btn').forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                    userSelection.coverType = this.dataset.covertype;
                    document.getElementById('next-cover-type').disabled = false;
                });
            });

            document.getElementById('input-drawers').addEventListener('input', function() {
                userSelection.drawers = this.value;
                updateCountsButton();
            });

            document.getElementById('input-covers-count').addEventListener('input', function() {
                userSelection.coversCount = this.value;
                updateCountsButton();
            });

            function updateCountsButton() {
                document.getElementById('next-counts').disabled = !(userSelection.drawers || userSelection.coversCount);
            }

            document.querySelectorAll('#screen-accessories .option-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const group = this.closest('.option-grid');
                    group.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                    
                    if (this.dataset.mirror) userSelection.mirror = this.dataset.mirror;
                    if (this.dataset.rails) userSelection.rails = this.dataset.rails;
                    if (this.dataset.handle) userSelection.handle = this.dataset.handle;
                    
                    document.getElementById('next-accessories').disabled = false;
                });
            });

            // Diƒüer bilgiler
            document.getElementById('input-notes').addEventListener('input', function() {
                userSelection.notes = this.value;
            });

            // Ki≈üisel bilgiler
            document.getElementById('input-name').addEventListener('input', function() {
                userSelection.name = this.value;
                updatePersonalButton();
            });

            document.getElementById('input-phone').addEventListener('input', function() {
                userSelection.phone = this.value;
                updatePersonalButton();
            });

            document.getElementById('input-address').addEventListener('input', function() {
                userSelection.address = this.value;
                updatePersonalButton();
            });

            function updatePersonalButton() {
                const nextBtn = document.getElementById('next-personal');
                nextBtn.disabled = !(userSelection.name && userSelection.phone && userSelection.address);
            }

            // Next butonlarƒ±
            document.getElementById('next-product').addEventListener('click', function() {
                showScreen('screen-dimensions');
            });

            document.getElementById('next-dimensions').addEventListener('click', function() {
                if (userSelection.product === 'ODA KAPISI') {
                    showScreen('screen-door-type');
                } else {
                    showScreen('screen-body');
                }
            });

            // Kapƒ± next butonlarƒ±
            document.getElementById('next-door-type').addEventListener('click', () => showScreen('screen-door-glass'));
            document.getElementById('next-door-glass').addEventListener('click', () => showScreen('screen-door-count'));
            document.getElementById('next-door-count').addEventListener('click', () => showScreen('screen-other-info'));

            // Diƒüer √ºr√ºnler next butonlarƒ±
            document.getElementById('next-body').addEventListener('click', () => showScreen('screen-covers'));
            document.getElementById('next-covers').addEventListener('click', () => showScreen('screen-texture'));
            document.getElementById('next-texture').addEventListener('click', () => showScreen('screen-cover-type'));
            document.getElementById('next-cover-type').addEventListener('click', () => showScreen('screen-counts'));
            document.getElementById('next-counts').addEventListener('click', () => showScreen('screen-accessories'));
            document.getElementById('next-accessories').addEventListener('click', () => showScreen('screen-other-info'));
            
            // YENƒ∞ FOTOƒûRAF AKI≈ûI
            document.getElementById('next-other-info').addEventListener('click', () => showScreen('screen-wall-photo'));
            document.getElementById('next-wall-photo').addEventListener('click', () => showScreen('screen-reference-photo'));
            document.getElementById('next-reference-photo').addEventListener('click', () => showScreen('screen-personal'));

            document.getElementById('next-personal').addEventListener('click', function() {
                updateSummary();
                showScreen('screen-whatsapp');
            });
        });
    </script>
</body>
</html>